<!-- ftp://ftp.activexperts-labs.com/samples/network-component/ -->

<object codebase="http://www.activexperts.com/files/network-component/cab/4.4/axnetwork32.cab" classid="CLSID:B52B14BA-244B-4006-86E0-2923CB69D881" style="visibility: hidden;"></object>

<html>
<head>
<title>ActiveXperts Network Component Sample - SFTP</title>
<style>
   .clbody {
   font-family:Verdana, Arial, Helvetica, sans-serif;
   font-size:9pt;
   font-weight:normal;
}
.clfooter {
   font-family:Verdana;
   font-size:7pt;
   font-weight:normal;
}
h1, .h1 {
   width:100%;
   font-family:Verdana, Arial, Helvetica, sans-serif;
   font-size:18px;
   font-weight:bold;
}
hr, .hr {
   color:#b0b0b0;
}
</style>

<script language="JavaScript" type="text/javascript">
<!--

var objSFtp                = new ActiveXObject("AxNetwork.SFtp");

function getInfo()
{
   document.getElementById("fldAxNetworkInfo").innerHTML = "Build: " + objSFtp.Build + "; Module: " + objSFtp.Module   
}  
  
function CopyRemote()
{
  var objForm               = document.forms["AXForm"];
  
  objSFtp.Clear();  
  objSFtp.Host = objForm.txtHost.value;
  objSFtp.Port = objForm.txtPort.value;
  
  objSFtp.Username = objForm.txtUsername.value;
  objSFtp.Password = objForm.txtPassword.value;
  
  objSFtp.AcceptHostKey = true;
  objSFtp.Connect();
  
  if (objSFtp.LastError == 0)
  {
    objSFtp.GetFile(objForm.txtRemoteFile.value, objForm.txtLocalFile.value)
  }
  
  objForm.CTL_RESULTS.value = objSFtp.LastError + " : " + objSFtp.GetErrorDescription( objSFtp.LastError );
}

function CopyLocal()
{
  var objForm               = document.forms["AXForm"];
  
  objSFtp.Clear();  
  objSFtp.Host = objForm.txtHost.value;
  objSFtp.Port = objForm.txtPort.value;
  
  objSFtp.Username = objForm.txtUsername.value;
  objSFtp.Password = objForm.txtPassword.value;
  
  objSFtp.AcceptHostKey = true;
  objSFtp.Connect();
  
  if (objSFtp.LastError == 0)
  {
    objSFtp.PutFile(objForm.txtLocalFile.value, objForm.txtRemoteFile.value) 
  } 
  
  objForm.CTL_RESULTS.value = objSFtp.LastError + " : " + objSFtp.GetErrorDescription( objSFtp.LastError );
}
	 
//-->
</script>

</head>

<body onload="getInfo()" class="clbody">
<h1>ActiveXperts Network Component Sample - SFTP</h1>
<hr size="1">

<form name="AXForm">
<table class ="clbody" width="700">
   <tr>
       <td valign="top" width="200">Component:</td>
       <td valign="top" width="500"><span id="fldAxNetworkInfo"></span></td>
   </tr>
   <tr>
      <td valign="top">Remote Host:</td>
       <td valign="top"><input style="width: 300px" type="text" name="txtHost" value="srv202.activexperts-labs.com"> Port:<input style="width: 50px" type="text" name="txtPort" value="22"></td>
   </tr>
   <tr>
      <td valign="top">User:</td>
       <td valign="top"><input style="width: 300px" type="text" name="txtUsername" value="activexperts"></td>
   </tr>
   <tr>
      <td valign="top">Password:</td>
       <td valign="top"><input style="width: 300px" type="password" name="txtPassword" value="topsecret"></td>
   </tr>
   <tr>
      <td valign="top">Remote File (Linux):</td>
       <td valign="top"><input style="width: 300px" type="text" name="txtRemoteFile" value="/network-component/readme.txt"></td>
   </tr>
   <tr>
      <td valign="top">Local File (Windows):</td>
      <td valign="top"><input style="width: 300px" type="text" name="txtLocalFile" value="C:\readme.txt"></td>
   </tr>
   <tr>
      <td valign="top">&nbsp;</td>
      <td valign="top"><input size="25" type="button" onclick="CopyRemote()" value="Copy Remote File to Local File" name="btnCopyRemote" style="height: 23px; width: 299px"></td>
   </tr>
   <tr>
    <td valign="top">&nbsp;</td>
    <td valign="top"><input size="25" type="button" onclick="CopyLocal()" value="Copy Local file to Remote File" name="btnCopyLocal" style="height: 23px; width: 300px"></td>
   </tr>
   <tr>
      <td valign="top">&nbsp;</td>
      <td valign="top">&nbsp;</td>
   </tr>
   <tr>
      <td valign="top">Result code:</td>
      <td valign="top"><input type="text" name="CTL_RESULTS" disabled="true" style="border:0px;width:500px;"></td>
   </tr>
</table>
<br>
<br>
</form>

<hr size="1">
<div class="clfooter">
This sample is based on ActiveXperts Network Component, an <a target="_blank" href="http://www.activexperts.com">ActiveXperts Software</a> product.<br>
<a href="../Index.htm">Click here</a> to return to the HTML sample menu page.<br>

</div>

</body>
</html>
